## 模线性方程组

**注：本题不计一血。**
已知 $n$ 元线性一次方程组和素数$p$。

$$ \begin{cases} a_{1, 1} x_1 + a_{1, 2} x_2 + \cdots + a_{1, n} x_n = b_1 \\ a_{2, 1} x_1 + a_{2, 2} x_2 + \cdots + a_{2, n} x_n = b_2 \\ \cdots \\ a_{n,1} x_1 + a_{n, 2} x_2 + \cdots + a_{n, n} x_n = b_n \end{cases}$$

请根据输入的数据，编程输出在模素数p的条件下方程组的解的情况。



根据线性代数中学到的，本题是解一个线性方程组

直接列出增广矩阵，是用高斯消元法求解

首先先回忆几个基本的矩阵操作

​1. 交换两行

​2. 一行乘一个非0的系数

​3. 将一行乘一个系数后加到另一行

对增广矩阵的三种操作都不会改变方程组的解

矩阵行数从1开始，列数从1开始

#### 高斯消元法的其中一种实现

分为n轮，在第i轮执行以下操作：

​1. 遍历第i行到第n行，找到第一个满足第i列元素不为0的行(设为第j行)，假如未找到，直接进入到下一轮中
​2. 将第i行和第j行交换元素
​3. 将第i行乘一个非0系数，满足运算后这一行第i列元素为 $1$
​4. 对第1行到第i-1行和第i+1行到第n行，每一行做如下处理，第i行乘一个系数加到这一行中，使得运算后这一行满足第i列元素为0

题目是放在素数域中，也就是在模p中求解，所以以上所有运算都要转换到相应的模运算。

唯一解是当n轮运算后，第i行(i=1,2,…n)第i列元素为1

无解是指，存在一行满足前n列元素为0,最后一列元素不为0

多解是指，在不满足无解的情况下，存在一行满足前n列元素为0,最后一列元素为0

#### 一个在模素数下的高斯消元例子

令素数为5，增广矩阵如下

$$ \left[ \matrix{2 & 4 & 5 & 2 \\ 3 & 1&2&4\\  4&1&2&1 } \right] $$

第1轮处理过程如下：

找到了第1行，将第1行和第1行交换

将第1行乘一个系数3，满足运算后第1列元素为1

$$ \left[ \matrix{1 & 2 & 0 & 1 \\ 3 & 1&2&4\\  4&1&2&1 } \right] $$

将第1行乘一个系数-3加到第2行，满足运算后第2行第1列元素为0

$$ \left[ \matrix{1 & 2 & 0 & 1 \\ 0 & 0&2&1\\  4&1&2&1 } \right] $$

将第1行乘一个系数-4加到第3行，满足运算后第3行第1列元素为0

$$ \left[ \matrix{1 & 2 & 0 & 1 \\ 0 & 0&2&1\\  0&3&2&2 } \right] $$

第2轮处理后，矩阵如下：

$$ \left[ \matrix{1 & 0 & 2 & 3 \\ 0 & 1&4&4\\  0&0&2&1 } \right] $$

第3轮处理后，矩阵如下：

$$ \left[ \matrix{1 & 0 & 0 & 2 \\ 0 & 1&0&2\\  0&0&1&3 } \right] $$

## 超能粒子炮 - 改

曾经发明了脑洞治疗仪与超能粒子炮的发明家 SHTSC 又公开了他的新发明：超能粒子炮・改——一种可以发射威力更加强大的粒子流的神秘装置。

超能粒子炮・改相比超能粒子炮，在威力上有了本质的提升。它有两个参数 $n,k$ ，它会向每个编号为 $0$ 到 $k$ （包含两端）的位置 $i$ 发射威力为 $C_{n}^{i} \bmod 2333$ 的粒子流。

现在 SHTSC 给出了他的超能粒子炮・改的参数，让你求出其发射的粒子流的威力之和除以 $2333$ 所得的余数。

#### 卢卡斯定理

$C^{m}_{n}\space mod\space p=C^{\lfloor m/p \rfloor}_{\lfloor n/p \rfloor}* C^{m\%p}_{n\%p}\space mod \space p$

卢卡斯定理证明：[卢卡斯定理 - OI Wiki (oi-wiki.org)](https://oi-wiki.org/math/number-theory/lucas/#证明)

#### 题目思路

于是我们设$f(n,k)=\sum^{k}_{i=0}C^{i}_{n}$

化式子

$$f(n,k)=\sum^{k}_{i=0}C^{i}_{n}\\=\sum^{k}_{i=0}C^{i/p}_{n/p }*C^{i\%p}_{n\%p}\\=C^{0}_{ n/p }*\sum^{p-1}_{i=0}*C^{i}_{n\%p}+C^{1}_{ n/p }*\sum^{p-1}_{i=0}*C^{i}_{n\%p}+...+C^{k/p}_{ n/p }*\sum^{k\%p}_{i=0}*C^{i}_{n\%p}$$

前面有$0$到$𝑘/𝑝−1$这些个整块，于是我们可以将$\sum^{p-1}_{i=0}*C^{i}_{n\%p}$提出来

变成

$\sum^{p-1}_{i=0}*C^{i}_{n\%p}*(C^{0}_{n/p}+C^{1}_{n/p}+...+C^{\frac{k}{p}-1}_{n/p})$

那这个东西岂不是可以写成

$ f(n\%p,p-1)*f(n/p,\frac{k} {p}-1)$

在加上那个不完整的块

$\sum^{k\%p}_{i=0}*C^{i}_{n\%p}$写出$f(n\%p,k\%p)$

于是就有

$f(n,k)=f(n\%p,p-1)*f(n/p,\frac{k} {p}-1)+C^{k/p}_{ n/p }*f(n\%p,k\%p)$

$C^{k/p}_{ n/p }$用卢卡斯来处理

## **移除奶牛**

Kevin和Nicky发明了一款新游戏。在这个游戏中，两名玩家轮流修改游戏状态，Kevin先移动。最初，游戏设置为有$n$堆奶牛，第$i$堆包含$a_i$奶牛。在每个玩家的回合中，该玩家调用神奇的力量，并将其用于以下选项之一：
1.从选定的非空堆中取出一头牛。
2.选择一堆大小均匀为$2·x（x>0）$的奶牛，并将其替换为$k$堆，每堆$x$头奶牛。
移除最后一头牛的玩家获胜。给定$n$，$k$和序列$a_1，a_2，…，a_n$，帮助Kevin和Nicky找到赢家，因为双方都以最佳方式比赛。

#### SG定理

为了详细说明 SG 定理，我们需要先定义 mex 函数——为 Minimal Excluded 的缩写，指一个非负整数集合 S 中的最小的没有被包含的非负整数。即：

​	$mex(S)=min${$x$}  $(x∉S,x∈N)$

SG 函数则是一个关于状态的函数。

对于终止状态，SG 函数值为 0；

否则，对于状态 $x$ 和它的所有 k 个后继状态 $y_1,y_2,…,y_k$，定义 $SG$ 函数：

$	SG(x)=mex${$SG(y_1 ),SG(y_2 ),…,SG(y_k )$}

SG 函数值为 0 的状态为必败状态，否则为必胜状态。

如上一页所说的，必败状态仅有 SG 值为 0 一种，而必胜状态却有很多种。

SG 定理的关键内容是：组合后的状态的 SG 值等于所有子游戏的状态的 SG 值的异或和。即：

$SG((s_1,s_2,…,s_n ))=SG(s_1 )⊕SG(s_2 )⊕…⊕SG(s_n )$

#### 题目思路

把每堆奶牛看出一个独立子游戏，那么整个游戏的SG值为：

$SG（整个游戏游戏）=SG(a_1)⊕ SG(a_2)⊕ ……⊕ SG(a_n)$

现在问题回到了如何求解独立子游戏的SG值，根据SG定理和SG函数定义可得：

x为奇数时，$SG(x)=mex${$SG(x-1)$},(对应操作：从堆中取出一头牛。)

x为偶数(x不为0)时，$SG(x)=mex${$SG(x-1),\sum^{k}_{i=1}SG(x/2) ⊕$}

(对应操作：从堆中取出一头牛。

对应操作：将其替换为*k*堆，每堆$x/2$头奶牛。)

$SG(0)=0$

根据SG函数值的求法，由异或性质$x ⊕x=0,x ⊕x ⊕x=x$

$SG(0)=0$

对k分奇偶讨论，

对k为奇数时：

​	x为奇数时，$SG(x)=mex${$SG(x-1)$}

​	x为偶数(x不为0)时，$SG(x)=mex${$SG(x-1),SG(x/2)$}

对k为偶数时：

​	x为奇数时，$SG(x)=mex${$SG(x-1)$}

​	x为偶数(x不为0)时，$SG(x)=mex${$SG(x-1),0$}

然后打表找规律即可。